# nohty

```py
djJKDBJWfjbekjfbejwkndKJBEJnfdwjKEkfnJKNFebigFUFEgw8fuBUFe8GFEUFGWEFGEUWFNOIEJfew = getattr(__builtins__, '\137\x5f\x64\151\x63\x74\x5f\137')['\147\x65\164\141\164\164\x72'](__builtins__, '\137\x5f\x64\151\x63\x74\x5f\137')['\147\x65\164\141\164\164\x72'](__builtins__, '\137\x5f\x64\151\x63\x74\x5f\137')['\147\x65\164\141\164\164\x72'](__builtins__, '\137\x5f\x64\151\x63\x74\x5f\137')['\147\x65\164\141\164\164\x72'](__builtins__, '\137\x5f\x64\151\x63\x74\x5f\137')['\147\x65\164\141\164\164\x72'](getattr(__builtins__, '\137\x5f\x64\151\x63\x74\x5f\137')[
    '\147\x65\164\141\164\164\x72'](__builtins__, '\137\x5f\x64\151\x63\x74\x5f\137')['\147\x65\164\141\164\164\x72'](__builtins__, '\137\x5f\x64\151\x63\x74\x5f\137')['\147\x65\164\141\164\164\x72'](__builtins__, '\137\x5f\x64\151\x63\x74\x5f\137')['\147\x65\164\141\164\164\x72'](__builtins__, '\137\x5f\x64\151\x63\x74\x5f\137')['\147\x65\164\141\164\164\x72'](__builtins__, '\137\x5f\x64\151\x63\x74\x5f\137')['\147\x65\164\141\164\164\x72'](__builtins__, '\137\x5f\x64\151\x63\x74\x5f\137')['__import__']('base64'), 'b64encode')
NjfenjfNEjfbiuHGfo8hOFEG67egFEgf78hofwHe8fhewfgew7FIew78fgEFehfoHFe8hoFge7GFewgFe7hf87W = lambda NjbnDJKWADBlJBDJHDBwhjLDBjekfbJLFbeflbeHJfbeJLFbehbfl, DHuiBDWUIqblUDBwhuBDwkfuBvfuyHwdbQWHbhdBQJKDWHQbqDQJDbwKQJ: bytes(
    [NjbnDJKWADBlJBDJHDBwhjLDBjekfbJLFbeflbeHJfbeJLFbehbfl[i] ^ DHuiBDWUIqblUDBwhuBDwkfuBvfuyHwdbQWHbhdBQJKDWHQbqDQJDbwKQJ[i % len(DHuiBDWUIqblUDBwhuBDwkfuBvfuyHwdbQWHbhdBQJKDWHQbqDQJDbwKQJ)] for i in range(len(NjbnDJKWADBlJBDJHDBwhjLDBjekfbJLFbeflbeHJfbeJLFbehbfl))])
hfbJFKBhjbnjBfebfewhlbEUIBfuEWBfehbfhefbhebfelBfehlbfheflebhf = lambda NjbnDJKWADBlJBDJHDBwhjLDBjekfbJLFbeflbeHJfbeJLFbehbfl, DHuiBDWUIqblUDBwhuBDwkfuBvfuyHwdbQWHbhdBQJKDWHQbqDQJDbwKQJ: NjfenjfNEjfbiuHGfo8hOFEG67egFEgf78hofwHe8fhewfgew7FIew78fgEFehfoHFe8hoFge7GFewgFe7hf87W(NjfenjfNEjfbiuHGfo8hOFEG67egFEgf78hofwHe8fhewfgew7FIew78fgEFehfoHFe8hoFge7GFewgFe7hf87W(djJKDBJWfjbekjfbejwkndKJBEJnfdwjKEkfnJKNFebigFUFEgw8fuBUFe8GFEUFGWEFGEUWFNOIEJfew(NjbnDJKWADBlJBDJHDBwhjLDBjekfbJLFbeflbeHJfbeJLFbehbfl), NjbnDJKWADBlJBDJHDBwhjLDBjekfbJLFbeflbeHJfbeJLFbehbfl) + NjfenjfNEjfbiuHGfo8hOFEG67egFEgf78hofwHe8fhewfgew7FIew78fgEFehfoHFe8hoFge7GFewgFe7hf87W(
    NjbnDJKWADBlJBDJHDBwhjLDBjekfbJLFbeflbeHJfbeJLFbehbfl, DHuiBDWUIqblUDBwhuBDwkfuBvfuyHwdbQWHbhdBQJKDWHQbqDQJDbwKQJ), DHuiBDWUIqblUDBwhuBDwkfuBvfuyHwdbQWHbhdBQJKDWHQbqDQJDbwKQJ) == b'0\x1e]Hi\xba\x1ab\x1aXWx\xe8Y\x1a[b)X\xa4Y2^rR-\x9f\x02\x1dRzX7\xfaV\x103]\x1bf\x95"=J\x15I{\xc3\x11\rZ\x07rv\x98C\x06#Q:s\xff=N\x00r\x7fs\x88\\F\x05^x;\xff@\x0f)\x15G5\xa0\x14L5\x11)c\xe29uo\x19sY\xb4\xaex\x14?NG\xb9\xae@@|SG\xd5\xef?i*bA\xa6\xf3QE~b`\xd6\xef?i*\x13\x0c\xa4\xe89x|\n}\x85\xa9`x/\x0e}\xa0\xe8[R\x18hW\x93\xe8[r#b\x18\xa2\xe0'
DHuiBDWUIqblUDBwhuBDwkfuBvfuyHwdbQWHbhdBQJKDWHQbqDQJDbwKQJ = [
    43, 12, 65, 124, 94, 184, 37]
if hfbJFKBhjbnjBfebfewhlbEUIBfuEWBfehbfhefbhebfelBfehlbfheflebhf(input("Password: ").encode("UTF-8"), DHuiBDWUIqblUDBwhuBDwkfuBvfuyHwdbQWHbhdBQJKDWHQbqDQJDbwKQJ):
    print("Bien jou√© ! Tu peux valider le challenge avec ce mot de passe !")
else:
    print("Hum ... je te pensais meilleur que √ßa ... üßê")
```

## Rename des variables

- On rename les variables qu'on peut identifier :

```py
longtruc = getattr(__builtins__, '\137\x5f\x64\151\x63\x74\x5f\137')['\147\x65\164\141\164\164\x72'](__builtins__, '\137\x5f\x64\151\x63\x74\x5f\137')['\147\x65\164\141\164\164\x72'](__builtins__, '\137\x5f\x64\151\x63\x74\x5f\137')['\147\x65\164\141\164\164\x72'](__builtins__, '\137\x5f\x64\151\x63\x74\x5f\137')['\147\x65\164\141\164\164\x72'](__builtins__, '\137\x5f\x64\151\x63\x74\x5f\137')['\147\x65\164\141\164\164\x72'](getattr(__builtins__, '\137\x5f\x64\151\x63\x74\x5f\137')[
    '\147\x65\164\141\164\164\x72'](__builtins__, '\137\x5f\x64\151\x63\x74\x5f\137')['\147\x65\164\141\164\164\x72'](__builtins__, '\137\x5f\x64\151\x63\x74\x5f\137')['\147\x65\164\141\164\164\x72'](__builtins__, '\137\x5f\x64\151\x63\x74\x5f\137')['\147\x65\164\141\164\164\x72'](__builtins__, '\137\x5f\x64\151\x63\x74\x5f\137')['\147\x65\164\141\164\164\x72'](__builtins__, '\137\x5f\x64\151\x63\x74\x5f\137')['\147\x65\164\141\164\164\x72'](__builtins__, '\137\x5f\x64\151\x63\x74\x5f\137')['__import__']('base64'), 'b64encode')

f1 = lambda arg1, arg2: bytes([arg1[i] ^ arg2[i % len(arg1)] for i in range(len(arg1))])

f2 = lambda arg1, arg2: f1(f1(longtruc(arg1), arg1) + f1(arg1, arg2), arg2) == b'0\x1e]Hi\xba\x1ab\x1aXWx\xe8Y\x1a[b)X\xa4Y2^rR-\x9f\x02\x1dRzX7\xfaV\x103]\x1bf\x95"=J\x15I{\xc3\x11\rZ\x07rv\x98C\x06#Q:s\xff=N\x00r\x7fs\x88\\F\x05^x;\xff@\x0f)\x15G5\xa0\x14L5\x11)c\xe29uo\x19sY\xb4\xaex\x14?NG\xb9\xae@@|SG\xd5\xef?i*bA\xa6\xf3QE~b`\xd6\xef?i*\x13\x0c\xa4\xe89x|\n}\x85\xa9`x/\x0e}\xa0\xe8[R\x18hW\x93\xe8[r#b\x18\xa2\xe0'

key = [43, 12, 65, 124, 94, 184, 37]
if f2(input("Password: ").encode("UTF-8"), key):
    print("Bien jou√© ! Tu peux valider le challenge avec ce mot de passe !")
else:
    print("Hum ... je te pensais meilleur que √ßa ... üßê")
```

- On peut identifier plus clairement la premiere fonction (regarde la fin) et des noms d'argument

```py
longtruc = b64encode

f1 = lambda password, key: bytes([password[i] ^ key[i % len(password)] for i in range(len(password))])

f2 = lambda password, key: f1(f1(longtruc(password), password) + f1(password, key), key) == b'0\x1e]Hi\xba\x1ab\x1aXWx\xe8Y\x1a[b)X\xa4Y2^rR-\x9f\x02\x1dRzX7\xfaV\x103]\x1bf\x95"=J\x15I{\xc3\x11\rZ\x07rv\x98C\x06#Q:s\xff=N\x00r\x7fs\x88\\F\x05^x;\xff@\x0f)\x15G5\xa0\x14L5\x11)c\xe29uo\x19sY\xb4\xaex\x14?NG\xb9\xae@@|SG\xd5\xef?i*bA\xa6\xf3QE~b`\xd6\xef?i*\x13\x0c\xa4\xe89x|\n}\x85\xa9`x/\x0e}\xa0\xe8[R\x18hW\x93\xe8[r#b\x18\xa2\xe0'

key = [43, 12, 65, 124, 94, 184, 37]
if f2(input("Password: ").encode("UTF-8"), key):
    print("Bien jou√© ! Tu peux valider le challenge avec ce mot de passe !")
else:
    print("Hum ... je te pensais meilleur que √ßa ... üßê")
```

- On reconnais que f2 est un xor (ou pas :c)


```py
longtruc = b64encode

xor = lambda password, key: bytes([password[i] ^ key[i % len(password)] for i in range(len(password))])

verif = lambda password, key: xor(xor(longtruc(password), password) + xor(password, key), key) == b'0\x1e]Hi\xba\x1ab\x1aXWx\xe8Y\x1a[b)X\xa4Y2^rR-\x9f\x02\x1dRzX7\xfaV\x103]\x1bf\x95"=J\x15I{\xc3\x11\rZ\x07rv\x98C\x06#Q:s\xff=N\x00r\x7fs\x88\\F\x05^x;\xff@\x0f)\x15G5\xa0\x14L5\x11)c\xe29uo\x19sY\xb4\xaex\x14?NG\xb9\xae@@|SG\xd5\xef?i*bA\xa6\xf3QE~b`\xd6\xef?i*\x13\x0c\xa4\xe89x|\n}\x85\xa9`x/\x0e}\xa0\xe8[R\x18hW\x93\xe8[r#b\x18\xa2\xe0'

key = [43, 12, 65, 124, 94, 184, 37]
if f2(input("Password: ").encode("UTF-8"), key):
    print("Bien jou√© ! Tu peux valider le challenge avec ce mot de passe !")
else:
    print("Hum ... je te pensais meilleur que √ßa ... üßê")
```

- Maintenant on peut noter que la longue chaine correspond √† : `xor(xor(longtruc(flag), flag) + xor(flag, key), key)`
- On sait aussi que `xor(xor(a,b),b) = a` et `xor(xor(a,b),a) = b`

```py 
key = [43, 12, 65, 124, 94, 184, 37]
text = b'0\x1e]Hi\xba\x1ab\x1aXWx\xe8Y\x1a[b)X\xa4Y2^rR-\x9f\x02\x1dRzX7\xfaV\x103]\x1bf\x95"=J\x15I{\xc3\x11\rZ\x07rv\x98C\x06#Q:s\xff=N\x00r\x7fs\x88\\F\x05^x;\xff@\x0f)\x15G5\xa0\x14L5\x11)c\xe29uo\x19sY\xb4\xaex\x14?NG\xb9\xae@@|SG\xd5\xef?i*bA\xa6\xf3QE~b`\xd6\xef?i*\x13\x0c\xa4\xe89x|\n}\x85\xa9`x/\x0e}\xa0\xe8[R\x18hW\x93\xe8[r#b\x18\xa2\xe0'

# xor(text, key) = xor(longtruc(flag), flag) + xor(flag, key)
data = xor(text, key)
```

- Pour s√©parer ce plus qui nous d√©range, on peut faire une boucle qui regarde tout les xor possible :


```py 
key = [43, 12, 65, 124, 94, 184, 37]
# xor(text, key) = xor(longtruc(flag), flag) + xor(flag, key)

data = xor(text, key)
for i in range(len(data)):
    print(xor(data[i:], key))
```

- Le flag est sous la forme HTN{...}